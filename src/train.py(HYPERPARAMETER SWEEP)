from src.model import build_model
def train_model(X_train,y_train):
  best_model=None
  best_loss=float(*inf*)
  for units in[32,64]:
    for epochs in [20,50]:
      model=build_model(X_train.shape[1:],units)
      history=model.fit(X_train, y_train,
                        epochs=10,batch_size=32,verbose=0)
      loss=history.history['loss'][-1]
      if loss<best_loss=loss
      best_model=model
 return best_model      
# Plot training vs validation loss
plt.figure()
plt.plot(history.history['loss'], label='Train Loss')
plt.plot(history.history['val_loss'], label='Validation Loss')
plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.title('Training vs Validation Loss')
plt.legend()

plt.savefig("training_validation_loss.png")
plt.close()                        
                       
